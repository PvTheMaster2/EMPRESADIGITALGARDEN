<!DOCTYPE html>
<html lang="pt-BR" class="theme-dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ title or page.fileSlug }} - {{ site.title }}</title>
  <meta name="description" content="{{ description or site.description }}" />
  
  <!-- CSS do tema Obsidian e customiza√ß√µes -->
  <link rel="stylesheet" href="/styles/main.css" />
  <link rel="stylesheet" href="/styles/sidebar.css" />
  <link rel="stylesheet" href="/styles/dashboard.css" />
  
  <!-- Chart.js para gr√°ficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Favicon e meta tags para PWA -->
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
  <meta name="theme-color" content="#1e1e1e" />
</head>
<body class="layout-dashboard">
  
  <header class="site-header">
    <nav class="main-navigation">
      <div class="nav-brand">
        <button class="mobile-sidebar-toggle" onclick="toggleSidebar()">
          <span class="hamburger"></span>
        </button>
        <a href="/" class="brand-link">
          üå± {{ site.title }}
        </a>
      </div>
      
      <div class="nav-links">
        <a href="/" class="active">Dashboard</a>
        <a href="/1-Governanca/README/">Governan√ßa</a>
        <a href="/4-Projetos/README/">Projetos</a>
        <a href="/2-Equipes/README/">Equipes</a>
        <a href="/5-Processos/README/">Processos</a>
        <a href="/6-Reunioes/README/">Reuni√µes</a>
        <a href="/7-Conhecimento/README/">Conhecimento</a>
      </div>
      
      <div class="nav-tools">
        <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
        <button class="search-toggle" onclick="toggleSearch()">üîç</button>
        <button class="refresh-dashboard" onclick="refreshDashboard()">üîÑ</button>
      </div>
    </nav>
  </header>

  <!-- Sidebar Navigation -->
  <aside class="sidebar" data-state="closed" aria-hidden="true">
    <div class="sidebar-header">
      <button class="sidebar-toggle" onclick="toggleSidebar()">
        <span class="hamburger"></span>
      </button>
      <div class="sidebar-brand">
        <a href="/" class="brand-link">üå± Multisocios</a>
      </div>
    </div>
    
    <div class="sidebar-content">
      <div class="sidebar-search">
        <input type="search" placeholder="Buscar conte√∫do..." class="search-input" id="sidebar-search">
      </div>
      
      <div class="sidebar-tree">
        <!-- Navega√ß√£o ser√° carregada via JavaScript -->
        <div id="navigation-tree"></div>
      </div>
    </div>
  </aside>

  <!-- Overlay para mobile -->
  <div class="sidebar-overlay" aria-hidden="true"></div>

  <!-- Main Content -->
  <main id="main" class="site-main" tabindex="-1">
    <div class="content-wrapper">
      
      <!-- Dashboard Header -->
      <header class="dashboard-header">
        <div class="dashboard-title-section">
          {% if title %}
          <h1 class="dashboard-title">{{ title }}</h1>
          {% endif %}
          <div class="dashboard-subtitle">
            <span class="last-updated">√öltima atualiza√ß√£o: {{ updated | date("DD/MM/YYYY HH:mm") or "Agora" }}</span>
            <span class="auto-refresh">üîÑ Atualiza√ß√£o autom√°tica</span>
          </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="quick-stats">
          <div class="stat-item projects">
            <div class="stat-icon">üìã</div>
            <div class="stat-content">
              <div class="stat-value" id="total-projects">8</div>
              <div class="stat-label">Projetos</div>
            </div>
          </div>
          <div class="stat-item budget">
            <div class="stat-icon">üí∞</div>
            <div class="stat-content">
              <div class="stat-value" id="total-budget">R$ 297k</div>
              <div class="stat-label">Budget</div>
            </div>
          </div>
          <div class="stat-item roi">
            <div class="stat-icon">üìà</div>
            <div class="stat-content">
              <div class="stat-value" id="avg-roi">347%</div>
              <div class="stat-label">ROI M√©dio</div>
            </div>
          </div>
          <div class="stat-item status">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-content">
              <div class="stat-value status-active">Online</div>
              <div class="stat-label">Sistema</div>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Dashboard Grid -->
      <div class="dashboard-grid">
        
        <!-- KPI Cards Row -->
        <div class="kpi-section">
          <div class="kpi-card revenue">
            <div class="kpi-header">
              <div class="kpi-icon">üí∞</div>
              <div class="kpi-title">Receita Total</div>
              <div class="kpi-trend up">‚ÜóÔ∏è</div>
            </div>
            <div class="kpi-value">R$ 1.2M</div>
            <div class="kpi-subtitle">+23% vs m√™s anterior</div>
            <div class="kpi-chart">
              <canvas id="revenueChart" width="200" height="60"></canvas>
            </div>
          </div>

          <div class="kpi-card projects-active">
            <div class="kpi-header">
              <div class="kpi-icon">üöÄ</div>
              <div class="kpi-title">Projetos Ativos</div>
              <div class="kpi-trend stable">‚Üí</div>
            </div>
            <div class="kpi-value">8</div>
            <div class="kpi-subtitle">2 em desenvolvimento</div>
            <div class="kpi-progress">
              <div class="progress-bar">
                <div class="progress-fill" style="width: 75%"></div>
              </div>
              <span class="progress-text">75% conclus√£o m√©dia</span>
            </div>
          </div>

          <div class="kpi-card team-capacity">
            <div class="kpi-header">
              <div class="kpi-icon">üë•</div>
              <div class="kpi-title">Capacidade da Equipe</div>
              <div class="kpi-trend up">‚ÜóÔ∏è</div>
            </div>
            <div class="kpi-value">85%</div>
            <div class="kpi-subtitle">Utiliza√ß√£o atual</div>
            <div class="capacity-indicators">
              <div class="capacity-item">
                <span class="capacity-label">Dev</span>
                <div class="capacity-bar">
                  <div class="capacity-fill" style="width: 90%"></div>
                </div>
              </div>
              <div class="capacity-item">
                <span class="capacity-label">Design</span>
                <div class="capacity-bar">
                  <div class="capacity-fill" style="width: 70%"></div>
                </div>
              </div>
            </div>
          </div>

          <div class="kpi-card performance">
            <div class="kpi-header">
              <div class="kpi-icon">‚ö°</div>
              <div class="kpi-title">Performance</div>
              <div class="kpi-trend up">‚ÜóÔ∏è</div>
            </div>
            <div class="kpi-value">94%</div>
            <div class="kpi-subtitle">Score geral</div>
            <div class="performance-metrics">
              <div class="metric-item">
                <span class="metric-dot quality"></span>
                <span class="metric-text">Qualidade: 96%</span>
              </div>
              <div class="metric-item">
                <span class="metric-dot speed"></span>
                <span class="metric-text">Velocidade: 92%</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
          <div class="chart-card projects-timeline">
            <div class="chart-header">
              <h3>üìä Timeline de Projetos</h3>
              <div class="chart-controls">
                <button class="chart-filter active" data-period="month">M√™s</button>
                <button class="chart-filter" data-period="quarter">Trimestre</button>
                <button class="chart-filter" data-period="year">Ano</button>
              </div>
            </div>
            <div class="chart-container">
              <canvas id="projectsTimelineChart"></canvas>
            </div>
          </div>

          <div class="chart-card budget-distribution">
            <div class="chart-header">
              <h3>üí∞ Distribui√ß√£o de Budget</h3>
              <div class="budget-total">Total: R$ 297k</div>
            </div>
            <div class="chart-container">
              <canvas id="budgetChart"></canvas>
            </div>
            <div class="budget-legend">
              <div class="legend-item">
                <span class="legend-dot" style="background: #667eea;"></span>
                <span>Desenvolvimento (40%)</span>
              </div>
              <div class="legend-item">
                <span class="legend-dot" style="background: #764ba2;"></span>
                <span>Marketing (25%)</span>
              </div>
              <div class="legend-item">
                <span class="legend-dot" style="background: #f093fb;"></span>
                <span>Opera√ß√µes (35%)</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Activity & Alerts -->
        <div class="activity-section">
          <div class="activity-card recent-updates">
            <div class="activity-header">
              <h3>üîî Atualiza√ß√µes Recentes</h3>
              <span class="activity-count">5 novos</span>
            </div>
            <div class="activity-list">
              <div class="activity-item">
                <div class="activity-icon project">üìã</div>
                <div class="activity-content">
                  <div class="activity-title">Projeto AERALYN atualizado</div>
                  <div class="activity-time">h√° 2 horas</div>
                </div>
                <div class="activity-status success">‚úÖ</div>
              </div>
              <div class="activity-item">
                <div class="activity-icon meeting">üìÖ</div>
                <div class="activity-content">
                  <div class="activity-title">Reuni√£o executiva conclu√≠da</div>
                  <div class="activity-time">h√° 4 horas</div>
                </div>
                <div class="activity-status info">‚ÑπÔ∏è</div>
              </div>
              <div class="activity-item">
                <div class="activity-icon budget">üí∞</div>
                <div class="activity-content">
                  <div class="activity-title">Budget aprovado para Q4</div>
                  <div class="activity-time">h√° 1 dia</div>
                </div>
                <div class="activity-status success">‚úÖ</div>
              </div>
            </div>
          </div>

          <div class="activity-card alerts">
            <div class="activity-header">
              <h3>‚ö†Ô∏è Alertas</h3>
              <span class="alert-count">2 ativos</span>
            </div>
            <div class="alerts-list">
              <div class="alert-item warning">
                <div class="alert-icon">‚ö†Ô∏è</div>
                <div class="alert-content">
                  <div class="alert-title">Budget pr√≥ximo do limite</div>
                  <div class="alert-description">Projeto Trip Match: 85% utilizado</div>
                </div>
                <button class="alert-action">Ver</button>
              </div>
              <div class="alert-item info">
                <div class="alert-icon">üìã</div>
                <div class="alert-content">
                  <div class="alert-title">Revis√£o de compliance</div>
                  <div class="alert-description">3 documentos pendentes</div>
                </div>
                <button class="alert-action">Revisar</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="actions-section">
          <div class="actions-card">
            <h3>‚ö° A√ß√µes R√°pidas</h3>
            <div class="actions-grid">
              <button class="action-btn primary">
                <div class="action-icon">‚ûï</div>
                <div class="action-text">Novo Projeto</div>
              </button>
              <button class="action-btn secondary">
                <div class="action-icon">üìÖ</div>
                <div class="action-text">Agendar Reuni√£o</div>
              </button>
              <button class="action-btn secondary">
                <div class="action-icon">üìä</div>
                <div class="action-text">Gerar Relat√≥rio</div>
              </button>
              <button class="action-btn secondary">
                <div class="action-icon">‚öôÔ∏è</div>
                <div class="action-text">Configura√ß√µes</div>
              </button>
            </div>
          </div>
        </div>

      </div>

      <!-- Dashboard Content (for additional content from markdown) -->
      {% if content %}
      <div class="dashboard-content">
        {{ content | safe }}
      </div>
      {% endif %}

    </div>
  </main>

  <!-- JavaScript -->
  <script src="/scripts/main.js"></script>
  <script src="/scripts/dashboard.js"></script>
  <script>
    // Dashboard-specific JavaScript
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize dashboard
      initializeDashboard();
      
      // Auto-refresh every 5 minutes
      setInterval(refreshDashboard, 300000);
      
      // Real-time updates simulation
      simulateRealTimeUpdates();
    });

    function initializeDashboard() {
      // Initialize charts
      initializeCharts();
      
      // Setup event listeners
      setupEventListeners();
      
      // Load initial data
      loadDashboardData();
    }

    function initializeCharts() {
      // Revenue Chart (mini sparkline)
      const revenueCtx = document.getElementById('revenueChart');
      if (revenueCtx) {
        new Chart(revenueCtx, {
          type: 'line',
          data: {
            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
            datasets: [{
              data: [800, 950, 1100, 1050, 1150, 1200],
              borderColor: '#10b981',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 2,
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              x: { display: false },
              y: { display: false }
            },
            elements: { point: { radius: 0 } }
          }
        });
      }

      // Projects Timeline Chart
      const timelineCtx = document.getElementById('projectsTimelineChart');
      if (timelineCtx) {
        new Chart(timelineCtx, {
          type: 'bar',
          data: {
            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
            datasets: [
              {
                label: 'Projetos Iniciados',
                data: [2, 3, 1, 4, 2, 3],
                backgroundColor: '#667eea'
              },
              {
                label: 'Projetos Conclu√≠dos',
                data: [1, 2, 3, 2, 3, 4],
                backgroundColor: '#764ba2'
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'top' }
            },
            scales: {
              y: { beginAtZero: true }
            }
          }
        });
      }

      // Budget Distribution Chart
      const budgetCtx = document.getElementById('budgetChart');
      if (budgetCtx) {
        new Chart(budgetCtx, {
          type: 'doughnut',
          data: {
            labels: ['Desenvolvimento', 'Marketing', 'Opera√ß√µes'],
            datasets: [{
              data: [40, 25, 35],
              backgroundColor: ['#667eea', '#764ba2', '#f093fb'],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            }
          }
        });
      }
    }

    function setupEventListeners() {
      // Chart filter buttons
      document.querySelectorAll('.chart-filter').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.chart-filter').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          // Update chart based on period
          updateChartPeriod(this.dataset.period);
        });
      });

      // Action buttons
      document.querySelectorAll('.action-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const action = this.querySelector('.action-text').textContent;
          handleQuickAction(action);
        });
      });
    }

    function loadDashboardData() {
      // Simulate data loading
      console.log('üìä Dashboard data loaded');
    }

    function refreshDashboard() {
      // Simulate refresh
      console.log('üîÑ Dashboard refreshed');
      
      // Update last updated time
      const lastUpdated = document.querySelector('.last-updated');
      if (lastUpdated) {
        lastUpdated.textContent = `√öltima atualiza√ß√£o: ${new Date().toLocaleString('pt-BR')}`;
      }
    }

    function simulateRealTimeUpdates() {
      // Simulate real-time updates every 30 seconds
      setInterval(() => {
        // Random small updates to metrics
        const projectsCount = document.getElementById('total-projects');
        const budgetTotal = document.getElementById('total-budget');
        const avgROI = document.getElementById('avg-roi');
        
        // Small random variations
        if (Math.random() > 0.7) {
          // Occasionally update values slightly
          console.log('üìà Real-time update simulated');
        }
      }, 30000);
    }

    function updateChartPeriod(period) {
      console.log(`üìä Updating charts for period: ${period}`);
      // Implementation for chart period updates
    }

    function handleQuickAction(action) {
      console.log(`‚ö° Quick action: ${action}`);
      // Implementation for quick actions
    }
  </script>
  
  <!-- Sidebar JavaScript -->
  <script src="/scripts/sidebar.js" defer></script>
</body>
</html>
